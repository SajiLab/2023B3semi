# B3プログラミングゼミ 第1回
今回実施する内容は以下の通りです。

- BMP ファイルの読み込み、書き出しの実装
- カラー画像とグレースケール画像の相互変換

実装の際は以下のようなことを考えてみてください。(ひょっとしたら考察のネタになるかも...)

- BMP ファイルはどのような構造になっているか \[[1]\] \[[2]\]
- 画像サイズはどのように計算されているか
- 画素値の最低値、最大値はいくつか、またなぜその値なのか
- 画素の座標(x,y) = (0,0)は画像のどの位置にあるか


[1]: https://algorithm.joho.info/image-processing/bmp-file-data-header/
[2]: https://qiita.com/spc_ehara/items/03d179f4901faeadb184

## ゼミで取り扱う画像について

第1回目のゼミでは画像処理技術ではなく、データとしての画像そのものについて触れておきましょう。

### ビットマップ画像(.bmp)


本ゼミで使用する画像はbmp(ビットマップ)形式と呼ばれるものです。画像を画素(pixel)と呼ばれる格子状に分割しており、その1つ1つが画素値と呼ばれる情報を持っています。一般的に画像の拡張子として知られている.jpgや.pngとは違い、**データを圧縮していない非圧縮データ**であることが最大の特徴です。その分、ファイルサイズも大きいことには注意しましょう。

### カラー画像
パターン認識の講義とは違い、今後の研究ではカラー画像を使用しての画像処理となります。

カラー画像は画素1ピクセルの色をR(赤)、G(緑)、B(青)の3原色で表現します。1画素のRGB要素を8ビットで表す24ビット画像が一般的です。

それぞれのチャンネルの画素値を抜き出した3つの画像を図1に示します。なぜ色がなくグレーであるのかは次の項でわかると思います。


<div>
<div style="text-align: center;">
<img src="semi_img/1_rgb_lenna.png">

図1 左からRチャンネル、Gチャンネル、Bチャンネル

</div>


### グレースケール画像

RGBカラー画像に対し、白黒の濃淡を表現した画像がグレースケール画像です。グレースケール画像は1画素を8ビットで表すため、色情報を持たず、明るさ情報のみを保持しています。画素値が0に近いほど画素は暗くなり、255に近いほど明るくなっていきます。



## 実装課題

今回はファイルの入出力処理、およびカラー画像をグレースケール画像に変換する処理を実装してもらいます。

処理を実装するファイルは以下の通りです。

- `myImage.hpp`：ヘッダファイル
   - クラスの定義
   - 関数のプロトタイプ宣言
- `fileio.cpp`：BMP 画像の入出力を行うソースファイル
- `color_convert.cpp`：グレースケール化の処理を行うソースファイル
- `main.cpp`：`main`関数が記述されているソースファイル


自分で新しくファイルを作成する、処理を追加する等は問題ありません。想定された処理が実装できる範囲内で、より良い処理を実装してみてください。


### 実装時のポイント

- 空欄を適切に埋めれば動作するようになっていますが、想定通りの動作が保証される範囲内でいくらでも改造を施して構いません。

- 作成したファイル名をCMakeLists.txt内`add_executable()`に入れてください。

- B3Semiディレクトリにおいてコマンド `$sh build_run.sh` で各ファイルをコンパイルから実行まで一括で行なうことができます。WSLにインストールがされていない方は以下のコマンドをWSL上で実行してみてください

```
$sudo apt install cmake
```

- C++では、定数表現にはconst修飾子を用いて値の保証を行うのが一般的です。const修飾子を利用することで、定数に対する誤った演算処理にはコンパイルエラーが発生し、バグを未然に防ぐことができます。効率的な実装のために積極的に使用するようにしてください。

- Visual Studio Codeの拡張機能である`Hex Editor`\[[3]\]は、bmpファイルのヘッダ情報を数値で直接確認することができます。考察のために必要ならば使ってみてください。

[3]: https://marketplace.visualstudio.com/items?itemName=ms-vscode.hexeditor 



## 実装について

基本的には、皆さんに提供したファイルのうち、`.cpp`ファイル、`.hpp`ファイル、`CMakeLists.txt`に追加・変更を行ってプログラムの実装を行なってもらいます。

プログラム中の変数や関数の定義については各ファイルにコメントの形で記述してありますので、必ず確認しながら実装を行ってください。

なお、実装においてわからないことがあれば SlackのB3ゼミ用チャンネル`b3ゼミ2023`で質問をお願いします。

